import { expect, use } from "chai";
import chaiAsPromised from "chai-as-promised";
import * as PhalaSdk from '@phala/sdk';
import type { KeyringPair } from '@polkadot/keyring/types';
import { ContractType } from '@devphase/service';
import {{contract_name_pascal}} from "@/typings/{{contract_name}}";

use(chaiAsPromised);

// Create a new instance of contract
const wsProvider = new WsProvider("ws://127.0.0.1:9944");
// Create a keyring instance
const keyring = new Keyring({ type: "sr25519" });

describe("{{contract_name}} test", () => {
  let {{contract_name}}Factory: {{contract_name_pascal}}.Factory;
  let {{contract_name}}Contract: {{contract_name_pascal}}.Contract;
  let api: ApiPromise;
  let deployer: KeyringPair;
  let certificate : PhalaSdk.CertificateData;

  let contract: {{contract_name_pascal}};
  const initialState = true;

  before(async function setup(): Promise<void> {
    api = await ApiPromise.create({ provider: wsProvider });
    deployer = keyring.addFromUri("//Alice");

    {{contract_name}}Factory = new {{contract_name_pascal}}Factory(api, deployer);

    contract = new {{contract_name_pascal}}(
      (await {{contract_name}}Factory.new(initialState)).address,
      deployer,
      api
    );
  });

  after(async function tearDown() {
    await api.disconnect();
  });
});
